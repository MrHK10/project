{% extends "base.html" %}
{% block title %}Other Locations{% endblock title %}
{% block body %}
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
    #map {
        width: 100%;
        height: 500px;
       
        margin-bottom: 20px;
    }

    .company-header {
       
        color: #fff;
        padding: 20px;
        border-top-left-radius: 20px;
        border-top-right-radius: 20px;
        margin-bottom: 20px;
        
    }
    h1, h1 {
        font-size: 2.5rem;
    }
    .company-details {
        background-color: #f9f9f9;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
        width: 100%;
    }

    .company-details h2 {
        margin-top: 0;
        font-size: 24px;
        color: #333;
    }

    .company-details p {
        margin-bottom: 10px;
        font-size: 16px;
    }

    .location-list {
        height: 420px; /* Set height to match the map */
        overflow-y: auto; /* Enable vertical scroll */
    }

    .location-item {
        background-color: #fff;
        border-radius: 5px;
        padding: 10px;
        margin-bottom: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .location-item h4 {
        margin-top: 0;
        margin-bottom: 5px;
        font-size: 18px;
        color: #333;
    }

    .location-item p {
        margin-bottom: 5px;
        font-size: 14px;
    }
</style>

<div class="container">
    <!-- Company Header -->
    <div class="company-header">
        <h1>{{ job.company_name }}</h1>
    </div>

    <div class="row">
        <div class="col-md-12">
            <!-- Display company details -->
            <div class="company-details">
                <h2>Company Details</h2>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Website:</strong> <a href="{{ job.website }}">{{ job.website }}</a></p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Job Location:</strong> {{ job.job_location }}</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Employees:</strong> {{ job.employees }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Locations:</strong> {{ job.locations }}</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Company</strong> {{ job.job_type }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Founded:</strong> {{ job.founded }}</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Revenue:</strong> {{ job.revenue }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Industry:</strong> {{ job.industry }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div id="map"></div>
            </div>
        </div>
        <div class="col-md-4">
            <!-- Display location details -->
            <div class="card">
                <div class="card-body">
                    <h2>Company Locations</h2>
                    <div class="location-list">
                        {% for location in locations %}
                        <div class="location-item">
                            <h4>{{ location.location_name }}</h4>
                            <p><strong>Latitude:</strong> {{ location.latitude }}</p>
                            <p><strong>Longitude:</strong> {{ location.longitude }}</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

<!-- Add this section to display recommended companies -->
<!-- Recommended Companies Section -->
<h1><b>Recommendations based on Industry</b></h1>
<div class="row">
    {% for company in random_companies %}
    <div class="col-md-4 mb-4">
        <div class="card border-primary h-100">
            <div class="card-body">
                <h5 class="card-title text-primary">{{ company.company_name }}</h5>
                <p class="card-text"><strong>Industry:</strong> {{ company.industry }}</p>
                <p class="card-text"><strong>Location:</strong> {{ company.job_location }}</p>
                <p class="card-text"><strong>Employees:</strong> {{ company.employees }}</p>
                <p><strong>More Locations: </strong><a href="{% url 'Alllocations' company_name=job.company_name %}">{{ job.locations }}</a></p>
                <!-- Add other company details as needed -->
            </div>
           
        </div>
    </div>
    {% endfor %}
</div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    // JavaScript to initialize the map and add markers for locations
    var locations = [
        {% for location in locations %}
        { "name": "{{ location.location_name }}", "address": "{{ location.address }}", "lat": {{ location.latitude }}, "lon": {{ location.longitude }} },
        {% endfor %}
    ];

    var map = L.map('map');

    var coordsArray = [];
    locations.forEach(function(loc) {
        coordsArray.push([loc.lat, loc.lon]);
    });

    var bounds = L.latLngBounds(coordsArray);
    map.fitBounds(bounds);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    locations.forEach(function(loc) {
        L.marker([loc.lat, loc.lon]).addTo(map)
            .bindPopup('<b>' + loc.name + '</b><br>' + loc.address);
    });
</script>

{% endblock body %}
